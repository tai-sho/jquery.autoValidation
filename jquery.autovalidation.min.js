 /**
  * jQuery autoValidation
  * @author ShoheiTai
  * @version 1.0
  * @license <a href="http://en.wikipedia.org/wiki/MIT_License">X11/MIT License</a>
  */
;(function($){var VALIDATE_EVENT='keyup blur';var INPUT_ERROR_CLASS='form-error';var ERROR_CLASS='error';var ERROR_SELECTOR='.'+ERROR_CLASS;var SCROLL_SPEED=400;var SCROLL_TARGET='form';var ERROR_TAG='span';var ERROR_ALERT=true;var msg={'master':'入力に誤りがあります。入力内容をご確認ください。','alphanumeric':'半角英数字で入力してください。','req':'必須入力です。','kana':'全角カタカナで入力してください。','mail':'メールアドレスの形式で入力してください。','short':'#STR1#字以上で入力してください。','long':'#STR1#字以下で入力してください。','half_num':'半角数字で入力してください。','full_num':'全角数字で入力してください。','num':'数字で入力してください。','between':'#STR1#字以上#STR2#字以下で入力してください。','nosame':'#STR1#と内容が一致しません。','_nosame':'値が一致しません。'};var valid={'isInputted':function(str){return(str.length!==0)},'isHalfNum':function(str){return(str.length===0||str.match(/^[0-9]+$/))},'isFullNum':function(str){return(str.length===0||str.match(/^[０-９]+$/))},'isHalfKana':function(str){return(str.length===0||str.match(/^[ｧ-ﾝﾞﾟ]+$/))},'isFullKana':function(str){return(str.length===0||str.match(/^[ァ-ー]+$/))},'isFullKanaName':function(str){return(str.length===0||str.match(/^[ァ-ヶー゛゜]*[　 ]*[ァ-ヶー゛゜]+$/))},'isMail':function(str){return(str.length===0||str.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/))},'isBetween':function(str,min,max){return(str.length===0||str.length>=min&&max>=str.length)},'isShort':function(str,min){return(str.length===0||min<=str.length)},'isLong':function(str,max){return(str.length===0||str.length<=max)},'isSame':function(str1,str2){return(str1===str2)},'isAlphanumeric':function(str){return(str.length===0||str.match(/^[a-zA-Z0-9]+$/))}};function toggleErrorHtml(dom,txt){if(txt.length===0){dom.next(ERROR_SELECTOR).remove();dom.removeClass(INPUT_ERROR_CLASS)}else{if(dom.next(ERROR_SELECTOR).length){dom.next(ERROR_SELECTOR).html(txt)}else{dom.after(getErrorHtml(txt))}dom.addClass(INPUT_ERROR_CLASS)}return true}function getErrorHtml(str){return'<'+ERROR_TAG+' class="'+ERROR_CLASS+'">'+str+'</'+ERROR_TAG+'>'}function getErrorText(type,replace1,replace2){var txt=msg[type];if(replace1){txt=txt.replace('#STR1#',replace1)}if(replace2){txt=txt.replace('#STR2#',replace2)}return txt}function validate(e){if(e.type==='keyup'&&e.keyCode===9)return false;var txt='';var str=$(this).val();var rules=e.data.rules;if(rules.required){if(!valid.isInputted(str)){if(rules.required.msg){txt=rules.required.msg}else{txt=getErrorText('req')}}}if(!txt){for(var rule in rules){if(rules[rule]['msg']){txt=rules[rule]['msg']}switch(rule){case'alphanumeric':if(!valid.isAlphanumeric(str)){txt=txt?txt:getErrorText('alphanumeric')}break;case'email':if(!valid.isMail(str)){txt=txt?txt:getErrorText('mail')}break;case'number':switch(rules[rule]['pitch']){case'full':if(!valid.isFullNum(str)){txt=txt?txt:getErrorText('full_num')}break;case'half':default:if(!valid.isHalfNum(str)){txt=txt?txt:getErrorText('half_num')}break}break;case'between':if(!valid.isBetween(str,rules[rule]['min'],rules[rule]['max'])){txt=txt?txt:getErrorText('between',rules[rule]['min'],rules[rule]['max'])}break;case'kana':if(!valid.isFullKana(str)){txt=txt?txt:getErrorText('kana')}break;case'name_kana':if(!valid.isFullKanaName(str)){txt=txt?txt:getErrorText('kana')}break;case'long':if(!valid.isLong(str,rules[rule]['max'])){txt=txt?txt:getErrorText('long',rules[rule]['max'])}break;case'short':if(!valid.isShort(str,rules[rule]['min'])){txt=txt?txt:getErrorText('kana',rules[rule]['min'])}break;case'equals':var _str=$(rules[rule]['target']).val();if(!valid.isSame(str,_str)){if(rules[rule]['name']){txt=txt?txt:getErrorText('nosame',rules[rule]['name'])}else{txt=txt?txt:getErrorText('_nosame')}}break}}}toggleErrorHtml($(this),txt)}$.fn.autoValidation=function(valid_opt,setting){for(var type in setting){switch(type){case'event':VALIDATE_EVENT=setting[type];break;case'errorInputClass':INPUT_ERROR_CLASS=setting[type];break;case'errorMsgClass':ERROR_CLASS=setting[type];ERROR_SELECTOR='.'+ERROR_CLASS;break;case'scrollSpeed':SCROLL_SPEED=setting[type];break;case'errorTag':ERROR_TAG=setting[type];break;case'scrollTarget':SCROLL_TARGET=setting[type];break;case'alert':if(setting[type]['out']===false){ERROR_ALERT=false}else if(setting[type]['msg']){msg.master=setting[type]['msg']}}}if(valid_opt){for(var sel in valid_opt){$(sel).bind(VALIDATE_EVENT,{'rules':valid_opt[sel]},validate)}}else{console.error('the setting was not found.')}this.submit(function(){var events=VALIDATE_EVENT.split(' ');$('form input').trigger(events[0]);var err=$(ERROR_SELECTOR);if(err.length>0){if(ERROR_ALERT){alert(msg.master)}if(SCROLL_TARGET){var position=$(SCROLL_TARGET).offset().top;$('body,html').animate({scrollTop:position},SCROLL_SPEED,'swing')}return false}})}})(jQuery);